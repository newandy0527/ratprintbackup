[gcode_macro AFC_POOP]
description: Dispatcher — choose Z‑safe poop when printing, original poop when idle
rename_existing: AFC_POOP_BASE

gcode:
    {% set printing = printer.print_stats.state == "printing" %}

    {% if printing %}
        RESPOND TYPE=command MSG="AFC_POOP: Printing detected → using AFC_POOP_AT_START_Z"
        AFC_POOP_BASE
    {% else %}
        RESPOND TYPE=command MSG="AFC_POOP: Not printing → using original AFC_POOP_BASE"
        AFC_POOP_BASE
    {% endif %}


